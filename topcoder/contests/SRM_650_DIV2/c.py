# -*- coding: utf-8 -*-

class mydict(dict):

  def __missing__(self, key):
    self[key] = []
    return self[key]

class TheKingsRoadsDiv2:

  def getAnswer(self, h, a, b):

    cnt = 1<<(h)
    flag = 0

    d = mydict()

    for x, y in zip(a, b):
      if x==y:
        flag += 1
      d[x].append(y)
      d[y].append(x)

    vis = None
    debug = 0
    # return if a tree is correct and it's depth
    def dfs(x):
      vis.add(x)
      tmp = 0
      a = []
      for i in d[x]:
        if i not in vis:
          tmp += 1
          t = dfs(i)
          a.append(t)
          if not t[0]:
            return 0,0
      if tmp == 2 and a[0] == a[1]:
        return 1,a[0][1]+1
      if tmp == 0:
        return 1, 1
      return 0,0


    if flag>1:
      return "Incorrect"
    if flag==1:
      if not d: return 'Correct'
      for i in xrange(1, cnt):
        if len(d[i]) == 2:
          vis = set()
          ret = dfs(i)
          if ret[0] and len(vis) == cnt-1:
            return 'Correct'
    else:
      for x, y in zip(a, b):
        d[x].remove(y)
        d[y].remove(x)
        for i in xrange(1, cnt):
          if len(d[i]) == 2:
            vis = set()
            ret = dfs(i)
            if ret[0] and len(vis) == cnt-1:
              return 'Correct'
            break
        d[x].append(y)
        d[y].append(x)

    return 'Incorrect'

if __name__ == '__main__':
  t = TheKingsRoadsDiv2()
  print t.getAnswer(3, [1, 2, 3, 7, 1, 5, 4], [6, 7, 4, 3, 3, 1, 7])
  print t.getAnswer(2, [1, 3, 3], [2, 1, 2])
  print t.getAnswer(1, [1], [1])
  print t.getAnswer(2, [1,1,1], [1,1,1])
  # not a complte binary tree
  print t.getAnswer(3, [4, 7, 7, 1, 1, 1, 4], [6, 5, 1, 7, 4, 3, 2])
  import sys
  sys.setrecursionlimit(10000000)
  print t.getAnswer(10, [742, 947, 865, 837, 570, 989, 785, 2, 3, 401, 22, 991, 669, 207, 464, 561, 757, 90, 157, 218, 391, 696, 787, 312, 737, 104, 243, 887, 452, 806, 349, 432, 542, 475, 140, 204, 678, 537, 598, 956, 638, 775, 342, 184, 736, 979, 912, 728, 17, 544, 603, 734, 143, 172, 540, 50, 15, 688, 855, 601, 673, 314, 412, 311, 262, 1019, 973, 770, 690, 198, 718, 511, 575, 769, 267, 755, 451, 11, 777, 847, 301, 889, 212, 492, 845, 949, 776, 201, 252, 680, 289, 138, 476, 800, 726, 962, 560, 457, 623, 817, 600, 896, 485, 413, 687, 56, 383, 257, 166, 714, 536, 129, 880, 870, 826, 927, 778, 662, 925, 877, 477, 466, 443, 506, 863, 856, 1015, 903, 81, 51, 146, 374, 875, 208, 38, 629, 317, 361, 838, 768, 254, 882, 63, 455, 881, 423, 119, 285, 946, 278, 339, 573, 117, 753, 275, 177, 111, 453, 231, 305, 293, 142, 526, 360, 359, 822, 794, 784, 330, 515, 73, 815, 23, 274, 581, 725, 928, 126, 414, 681, 268, 130, 648, 174, 530, 441, 405, 167, 370, 422, 952, 442, 1022, 220, 200, 139, 148, 39, 296, 583, 427, 72, 812, 354, 1003, 1012, 258, 419, 773, 582, 980, 578, 223, 906, 565, 628, 350, 409, 281, 982, 121, 288, 271, 745, 500, 571, 595, 844, 828, 488, 188, 1011, 269, 424, 556, 290, 404, 533, 239, 13, 431, 852, 328, 676, 709, 683, 244, 52, 876, 1001, 481, 546, 26, 636, 733, 280, 152, 410, 19, 421, 456, 944, 426, 926, 564, 878, 599, 6, 199, 437, 446, 472, 379, 821, 131, 235, 931, 214, 789, 306, 113, 315, 385, 299, 939, 960, 634, 550, 596, 478, 77, 941, 940, 406, 922, 115, 783, 4, 525, 954, 762, 868, 176, 913, 331, 747, 665, 62, 97, 682, 318, 310, 320, 357, 332, 168, 568, 45, 961, 394, 403, 829, 266, 70, 644, 520, 8, 890, 917, 639, 620, 155, 96, 375, 224, 145, 297, 516, 684, 555, 818, 901, 1013, 612, 958, 484, 33, 334, 192, 656, 649, 850, 589, 667, 786, 68, 7, 534, 181, 630, 294, 632, 205, 108, 75, 496, 809, 479, 264, 505, 625, 998, 585, 619, 1, 283, 655, 586, 1014, 307, 1000, 483, 744, 951, 324, 671, 101, 356, 120, 966, 984, 948, 930, 337, 153, 74, 698, 765, 587, 102, 626, 251, 529, 84, 259, 353, 183, 1005, 237, 710, 245, 801, 814, 308, 364, 510, 538, 232, 813, 123, 860, 185, 343, 899, 967, 652, 341, 58, 16, 886, 964, 862, 513, 151, 321, 617, 333, 246, 80, 522, 892, 169, 976, 291, 474, 717, 272, 345, 160, 5, 545, 21, 919, 754, 43, 88, 692, 298, 225, 879, 156, 313, 978, 54, 260, 780, 819, 685, 883, 229, 67, 920, 588, 240, 430, 987, 388, 633, 213, 885, 713, 905, 187, 750, 393, 888, 435, 103, 759, 118, 751, 661, 270, 706, 382, 149, 749, 524, 893, 303, 344, 241, 955, 917, 47, 763, 193, 934, 635, 731, 497, 695, 460, 495, 482, 380, 975, 59, 779, 1004, 531, 238, 161, 386, 646, 873, 221, 105, 832, 202, 693, 425, 480, 494, 277, 993, 351, 924, 85, 968, 436, 659, 228, 616, 675, 439, 489, 362, 127, 668, 76, 739, 395, 1018, 758, 79, 943, 793, 348, 849, 953, 689, 66, 916, 210, 971, 340, 577, 756, 937, 465, 458, 514, 368, 827, 562, 874, 795, 438, 672, 576, 429, 236, 792, 721, 128, 938, 91, 230, 658, 444, 327, 493, 631, 27, 206, 468, 702, 34, 618, 100, 613, 679, 216, 551, 637, 217, 249, 471, 904, 990, 871, 641, 89, 825, 918, 957, 454, 347, 141, 872, 189, 255, 609, 355, 365, 300, 699, 700, 843, 811, 504, 30, 433, 1021, 691, 977, 248, 859, 110, 491, 173, 716, 653, 923, 528, 942, 607, 165, 541, 715, 796, 369, 65, 323, 112, 462, 387, 366, 498, 1002, 985, 1023, 983, 247, 1016, 835, 253, 371, 858, 929, 1007, 1020, 295, 921, 411, 473, 740, 114, 194, 799, 650, 329, 810, 28, 864, 486, 399, 840, 211, 853, 720, 416, 180, 664, 594, 1008, 219, 363, 730, 203, 897, 788, 109, 802, 186, 651, 654, 527, 319, 910, 256, 459, 539, 994, 836, 723, 98, 467, 543, 704, 99, 182, 997, 122, 179, 415, 790, 846, 316, 106, 805, 191, 866, 31, 580, 372, 914, 547, 738, 724, 196, 621, 712, 999, 392, 116, 234, 69, 674, 781, 988, 969, 53, 804, 909, 398, 227, 869, 915, 470, 286, 643, 611, 708, 78, 10, 549, 719, 841, 265, 36, 508, 703, 657, 972, 378, 936, 791, 959, 195, 434, 945, 604, 735, 857, 487, 566, 215, 861, 559, 729, 1010, 463, 574, 20, 428, 287, 29, 572, 848, 41, 376, 842, 95, 557, 590, 87, 974, 61, 986, 273, 390, 57, 175, 447, 384, 553, 304, 450, 37, 279, 261, 60, 569, 136, 135, 417, 774, 521, 622, 124, 732, 93, 276, 894, 701, 760, 867, 400, 367, 302, 567, 764, 900, 624, 133, 965, 440, 933, 448, 597, 461, 501, 352, 263, 292, 397, 163, 563, 335, 640, 407, 645, 895, 686, 134, 891, 602, 746, 519, 144, 509, 44, 282, 377, 694, 752, 1006, 647, 35, 197, 132, 150, 798, 820, 326, 499, 851, 908, 807, 766, 502, 178, 92, 663, 996, 711, 548, 147, 741, 605, 346, 584, 25, 336, 1009, 64, 158, 46, 512, 831, 932, 705, 902, 381, 803, 591, 995, 834, 884, 992, 83, 772, 373, 162, 94, 517, 469, 830, 854, 164, 170, 42, 554, 518, 503, 418, 532, 771, 40, 660, 615, 761, 325, 18, 950, 666, 697, 748, 707, 839, 523, 125, 592, 190, 338, 408, 242, 154, 970, 963, 49, 782, 24, 935, 642, 159, 322, 358, 507, 722, 558, 402, 535, 396, 209, 797, 981, 389, 907, 86, 171, 767, 32, 48, 71, 593, 677, 445, 743, 911, 614, 627, 579, 12, 449, 222, 833, 816, 226, 670, 284, 14, 824, 610, 107, 552, 233, 9, 137, 898, 823, 55, 1017, 250, 490, 606, 309, 608, 420, 727, 82], [412, 94, 678, 418, 9, 563, 151, 395, 572, 523, 4, 127, 832, 489, 809, 12, 338, 462, 391, 199, 266, 600, 536, 614, 104, 656, 791, 251, 205, 941, 661, 822, 290, 221, 762, 163, 70, 472, 958, 518, 765, 398, 1018, 115, 211, 818, 1017, 790, 498, 718, 52, 207, 904, 742, 746, 416, 1016, 45, 721, 220, 140, 540, 715, 430, 92, 1006, 777, 785, 738, 373, 534, 804, 328, 434, 538, 608, 565, 866, 882, 753, 653, 971, 1009, 217, 644, 840, 671, 909, 83, 277, 967, 313, 249, 950, 424, 767, 1008, 743, 285, 984, 857, 500, 254, 1022, 961, 173, 32, 811, 185, 735, 716, 40, 506, 237, 234, 510, 454, 95, 895, 44, 640, 826, 23, 306, 691, 399, 346, 58, 638, 423, 533, 364, 830, 100, 719, 839, 25, 458, 1021, 665, 453, 124, 280, 49, 622, 627, 186, 659, 336, 160, 881, 27, 157, 477, 928, 680, 378, 631, 740, 350, 243, 148, 106, 997, 212, 31, 394, 511, 623, 651, 571, 582, 6, 382, 784, 26, 868, 835, 15, 592, 441, 570, 976, 860, 343, 269, 164, 528, 180, 654, 590, 102, 232, 963, 816, 208, 905, 657, 145, 799, 620, 73, 445, 261, 709, 282, 404, 754, 204, 490, 987, 348, 579, 323, 14, 708, 763, 258, 748, 93, 632, 136, 380, 891, 281, 898, 156, 450, 512, 444, 795, 396, 411, 478, 648, 630, 240, 872, 317, 89, 363, 465, 347, 639, 1011, 999, 854, 352, 878, 544, 780, 978, 307, 342, 61, 376, 383, 114, 568, 894, 87, 242, 358, 74, 262, 37, 189, 452, 56, 641, 849, 475, 679, 496, 1013, 977, 289, 1012, 384, 339, 501, 194, 437, 153, 38, 634, 948, 927, 725, 981, 128, 935, 515, 284, 337, 1019, 682, 519, 461, 392, 137, 983, 296, 739, 98, 386, 532, 188, 480, 757, 564, 405, 829, 432, 609, 494, 933, 516, 664, 139, 574, 714, 673, 728, 403, 686, 216, 245, 628, 838, 921, 202, 879, 171, 131, 33, 451, 275, 111, 876, 1004, 63, 594, 864, 688, 677, 749, 938, 567, 59, 238, 772, 86, 797, 179, 486, 752, 257, 991, 278, 624, 993, 820, 988, 292, 890, 548, 745, 1005, 645, 333, 937, 184, 315, 802, 962, 367, 810, 635, 884, 808, 667, 979, 649, 192, 850, 867, 507, 1001, 90, 800, 662, 798, 351, 397, 733, 694, 175, 374, 734, 370, 793, 823, 922, 875, 955, 132, 492, 88, 479, 319, 605, 817, 530, 181, 272, 684, 588, 215, 775, 554, 521, 782, 491, 365, 619, 769, 837, 852, 766, 621, 99, 302, 362, 13, 433, 814, 250, 569, 309, 943, 436, 125, 286, 732, 176, 85, 334, 996, 419, 980, 813, 550, 448, 407, 482, 547, 62, 493, 141, 381, 5, 693, 695, 16, 815, 986, 499, 899, 944, 345, 969, 968, 259, 21, 172, 442, 11, 274, 761, 130, 425, 488, 54, 683, 34, 524, 526, 222, 152, 525, 426, 142, 105, 551, 371, 911, 120, 484, 456, 945, 566, 847, 1000, 841, 589, 359, 974, 187, 597, 43, 197, 209, 862, 178, 469, 831, 48, 741, 607, 196, 553, 549, 801, 246, 918, 60, 497, 599, 616, 321, 893, 298, 471, 907, 229, 851, 897, 439, 214, 887, 108, 256, 916, 68, 646, 871, 618, 825, 787, 1023, 771, 805, 236, 919, 76, 558, 575, 121, 581, 689, 675, 781, 206, 869, 1015, 931, 438, 824, 773, 288, 97, 244, 19, 700, 731, 917, 539, 335, 576, 711, 193, 483, 807, 865, 770, 415, 833, 601, 939, 332, 1007, 842, 727, 368, 299, 354, 913, 729, 848, 318, 930, 219, 726, 885, 751, 247, 704, 464, 685, 615, 658, 843, 230, 783, 24, 652, 561, 42, 226, 467, 827, 271, 264, 198, 414, 522, 129, 873, 422, 699, 387, 325, 29, 255, 578, 819, 514, 10, 233, 901, 940, 260, 542, 420, 504, 303, 914, 959, 312, 225, 702, 466, 366, 146, 268, 995, 953, 485, 82, 970, 64, 942, 369, 2, 557, 150, 55, 994, 123, 660, 910, 915, 637, 617, 755, 324, 947, 707, 744, 165, 636, 676, 672, 712, 531, 72, 138, 28, 687, 737, 161, 287, 670, 888, 291, 982, 39, 972, 119, 417, 870, 227, 402, 585, 231, 906, 195, 252, 924, 167, 447, 149, 759, 698, 555, 75, 902, 341, 789, 344, 792, 764, 22, 20, 613, 696, 932, 322, 954, 340, 35, 668, 46, 889, 541, 697, 213, 957, 53, 143, 263, 177, 1010, 610, 473, 537, 330, 934, 602, 595, 355, 375, 545, 611, 476, 926, 427, 169, 265, 861, 50, 877, 273, 788, 96, 18, 856, 503, 717, 377, 17, 91, 267, 690, 118, 183, 562, 314, 509, 293, 253, 468, 598, 929, 701, 1020, 65, 912, 460, 413, 633, 966, 147, 593, 992, 300, 41, 903, 224, 543, 457, 650, 803, 126, 174, 295, 965, 304, 951, 990, 806, 527, 925, 109, 845, 393, 294, 443, 722, 71, 326, 836, 794, 158, 168, 474, 80, 81, 353, 57, 546, 587, 591, 201, 1000, 311, 580, 400, 720, 421, 401, 117, 144, 122, 223, 859, 410, 495, 155, 626, 481, 8, 360, 182, 768, 103, 248, 508, 297, 487, 774, 305, 431, 116, 612, 101, 855, 279, 863, 203, 756, 669, 920, 552, 821, 577, 1014, 779, 162, 883, 778, 69, 844, 964, 379, 758, 603, 241, 67, 886, 190, 520, 276, 159, 327, 135, 936, 760, 218, 960, 663, 703, 79, 389, 408, 66, 409, 513, 283, 320, 535, 952, 36, 573, 713, 560, 604, 583, 706, 406, 517, 191, 853, 692, 796, 329, 776, 449, 356, 896, 429, 47, 1003, 747, 985, 390, 357, 892, 361, 463, 7, 625, 113, 308, 946, 170, 239, 385, 78, 154, 584, 606, 900, 846, 459, 858, 110, 440, 705, 349, 134, 908, 710, 586, 502, 107, 559, 989, 730, 235, 1002, 828, 666, 629, 956, 455, 834, 736, 470, 643, 3, 681, 51, 331, 750, 647, 301, 505, 388, 812, 372, 200, 723, 133, 998, 923, 655, 446, 270, 1, 30, 880, 316, 112, 228, 210, 310, 166, 84, 428, 596, 674, 642, 975, 77, 556, 973, 435, 529, 724, 949, 786])
